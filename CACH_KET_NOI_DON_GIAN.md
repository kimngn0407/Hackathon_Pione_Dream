# ğŸ”— CÃCH CÃC PHáº¦N Káº¾T Ná»I Vá»šI NHAU - ÄÆ N GIáº¢N

## ğŸ“Š **SÆ  Äá»’ Káº¾T Ná»I**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          NGÆ¯á»œI DÃ™NG                    â”‚
â”‚     (TrÃ¬nh duyá»‡t web/Mobile)          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â†“ (1) Truy cáº­p website
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         FRONTEND (Vercel)              â”‚
â”‚  hackathon-pione-dream.vercel.app      â”‚
â”‚                                        â”‚
â”‚  - Giao diá»‡n ngÆ°á»i dÃ¹ng                â”‚
â”‚  - Upload áº£nh, nháº­p dá»¯ liá»‡u            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â†“ (2) Gá»i API qua fetch/axios
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      BACKEND API (Railway)             â”‚
â”‚  hackathonpionedream-production.       â”‚
â”‚         up.railway.app                 â”‚
â”‚                                        â”‚
â”‚  - Nháº­n request tá»« Frontend            â”‚
â”‚  - Xá»­ lÃ½ logic                         â”‚
â”‚  - Gá»i AI services                     â”‚
â””â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â”‚         â”‚          â”‚
   â”‚         â”‚          â””â”€â”€> (3a) LÆ°u/Ä‘á»c dá»¯ liá»‡u
   â”‚         â”‚               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚         â”‚               â”‚   DATABASE      â”‚
   â”‚         â”‚               â”‚  (PostgreSQL)   â”‚
   â”‚         â”‚               â”‚    Railway      â”‚
   â”‚         â”‚               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â”‚         â”‚
   â”‚         â””â”€â”€> (3b) Gá»i Crop AI
   â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚              â”‚  Crop Recommendation AI  â”‚
   â”‚              â”‚  hackathon-pione-dream.  â”‚
   â”‚              â”‚      onrender.com        â”‚
   â”‚              â”‚  - Gá»£i Ã½ cÃ¢y trá»“ng       â”‚
   â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â”‚
   â””â”€â”€> (3c) Gá»i Pest AI
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  Pest & Disease Detection AI â”‚
        â”‚  kimngan0407-pest-disease.   â”‚
        â”‚        hf.space              â”‚
        â”‚  - PhÃ¡t hiá»‡n sÃ¢u bá»‡nh        â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”§ **CÃCH HOáº T Äá»˜NG**

### **BÆ¯á»šC 1: NgÆ°á»i dÃ¹ng truy cáº­p Frontend**

```
URL: https://hackathon-pione-dream.vercel.app/
```

- NgÆ°á»i dÃ¹ng má»Ÿ trÃ¬nh duyá»‡t
- Nháº­p URL hoáº·c click link
- Frontend load giao diá»‡n

### **BÆ¯á»šC 2: Frontend gá»i Backend**

**VÃ­ dá»¥:** NgÆ°á»i dÃ¹ng upload áº£nh lÃ¡ bá»‡nh

```javascript
// Frontend code (JavaScript)
const formData = new FormData();
formData.append('file', imageFile);

fetch('https://hackathonpionedream-production.up.railway.app/api/pest-disease/detect', {
  method: 'POST',
  body: formData
})
.then(response => response.json())
.then(result => {
  console.log('Bá»‡nh phÃ¡t hiá»‡n:', result.predicted_class);
  console.log('Äá»™ chÃ­nh xÃ¡c:', result.confidence);
});
```

### **BÆ¯á»šC 3: Backend nháº­n request vÃ  gá»i AI**

**Backend code (Java):**

```java
// PestDiseaseController.java
@PostMapping("/api/pest-disease/detect")
public ResponseEntity<Map> detectDisease(@RequestParam("file") MultipartFile file) {
    // Gá»i PestDiseaseService
    Map<String, Object> result = pestDiseaseService.detectDisease(file);
    return ResponseEntity.ok(result);
}

// PestDiseaseService.java
public Map<String, Object> detectDisease(MultipartFile file) {
    // Gá»i AI service á»Ÿ Hugging Face
    String url = "https://kimngan0407-pest-disease.hf.space/api/detect";
    
    // Gá»­i áº£nh Ä‘áº¿n AI
    HttpEntity<MultipartFile> request = new HttpEntity<>(file);
    ResponseEntity<Map> response = restTemplate.postForEntity(url, request, Map.class);
    
    // Tráº£ káº¿t quáº£ vá» Frontend
    return response.getBody();
}
```

### **BÆ¯á»šC 4: AI xá»­ lÃ½ vÃ  tráº£ káº¿t quáº£**

```python
# Pest AI (Python - Hugging Face)
@app.route('/api/detect', methods=['POST'])
def detect():
    image = request.files['file']
    
    # Load vÃ  xá»­ lÃ½ áº£nh
    img = Image.open(image)
    
    # Cháº¡y model AI
    prediction = model.predict(img)
    
    # Tráº£ káº¿t quáº£
    return {
        "predicted_class": "Brown Rust",
        "confidence": 0.95
    }
```

### **BÆ¯á»šC 5: Káº¿t quáº£ tráº£ vá» Frontend**

```
Backend â†’ Frontend: {
  "predicted_class": "Brown Rust",
  "confidence": 0.95
}
```

Frontend hiá»ƒn thá»‹ cho ngÆ°á»i dÃ¹ng:
```
Káº¿t quáº£: Bá»‡nh Brown Rust
Äá»™ chÃ­nh xÃ¡c: 95%
```

---

## ğŸ”— **CÃC URL Káº¾T Ná»I**

### **1. Frontend â†’ Backend**

```javascript
// Frontend config
const BACKEND_URL = 'https://hackathonpionedream-production.up.railway.app';

// CÃ¡c endpoints:
const API = {
  // Pest & Disease
  pestDetect: `${BACKEND_URL}/api/pest-disease/detect`,
  pestClasses: `${BACKEND_URL}/api/pest-disease/classes`,
  
  // Crop Recommendation
  cropRecommend: `${BACKEND_URL}/api/crop/recommend`,
  
  // Sensors
  sensors: `${BACKEND_URL}/api/sensors`,
  
  // Auth
  login: `${BACKEND_URL}/api/auth/login`,
};
```

### **2. Backend â†’ AI Services**

```properties
# Backend config (application.properties)

# URL cá»§a Pest AI
pest.disease.service.url=https://kimngan0407-pest-disease.hf.space

# URL cá»§a Crop AI
crop.recommendation.service.url=https://hackathon-pione-dream.onrender.com

# Database tá»± Ä‘á»™ng connect qua Railway environment variables
```

---

## âœ… **ÄÃƒ Cáº¤U HÃŒNH XO**

### âœ… Backend cÃ³ thá»ƒ gá»i AI:
- ÄÃ£ táº¡o `PestDiseaseService.java`
- ÄÃ£ táº¡o `AIRecommendationService.java`
- ÄÃ£ config URLs trong `application.properties`

### âœ… Frontend cÃ³ thá»ƒ gá»i Backend:
- ÄÃ£ setup CORS trong `CorsConfig.java`
- Frontend domains Ä‘Ã£ Ä‘Æ°á»£c whitelist:
  - `https://hackathon-pione-dream.vercel.app`
  - `https://hackathon-pione-dream-vzj5.vercel.app`
  - `http://localhost:3000` (cho dev)

### âœ… Backend káº¿t ná»‘i Database:
- Tá»± Ä‘á»™ng qua Railway environment variables
- KhÃ´ng cáº§n config thÃªm

---

## ğŸ§ª **TEST Káº¾T Ná»I**

### **Test 1: Frontend â†’ Backend**

Má»Ÿ Console trong trÃ¬nh duyá»‡t (F12) vÃ  cháº¡y:

```javascript
fetch('https://hackathonpionedream-production.up.railway.app/api/pest-disease/health')
  .then(r => r.json())
  .then(data => console.log(data));
```

**Káº¿t quáº£ mong Ä‘á»£i:**
```json
{
  "service": "pest-disease",
  "status": "healthy",
  "ai_api_connected": true
}
```

### **Test 2: Backend â†’ Pest AI**

```bash
curl https://hackathonpionedream-production.up.railway.app/api/pest-disease/classes
```

**Káº¿t quáº£ mong Ä‘á»£i:**
```json
{
  "classes": ["Brown Rust", "Healthy", "Septoria", "Yellow Rust"]
}
```

### **Test 3: ToÃ n bá»™ flow**

1. Má»Ÿ Frontend: `https://hackathon-pione-dream.vercel.app/`
2. Upload áº£nh lÃ¡ bá»‡nh
3. Click "PhÃ¡t hiá»‡n"
4. Xem káº¿t quáº£ hiá»ƒn thá»‹

**Flow hoÃ n chá»‰nh:**
```
User â†’ Frontend â†’ Backend â†’ Pest AI â†’ Backend â†’ Frontend â†’ User
   |      |          |          |          |         |        |
Upload  Send to   Forward   Analyze   Return   Display  See
Image   Backend   to AI     Image    Result   Result  Result
```

---

## ğŸ” **Báº¢O Máº¬T**

### **CORS (Cross-Origin Resource Sharing)**

**Váº¥n Ä‘á»:** TrÃ¬nh duyá»‡t cháº·n Frontend gá»i Backend tá»« domain khÃ¡c

**Giáº£i phÃ¡p Ä‘Ã£ Ã¡p dá»¥ng:**

```java
// Backend: CorsConfig.java
@Configuration
public class CorsConfig {
    @Bean
    public CorsFilter corsFilter() {
        // Cho phÃ©p cÃ¡c domains nÃ y gá»i Backend
        config.setAllowedOrigins(Arrays.asList(
            "https://hackathon-pione-dream.vercel.app",    // Frontend
            "https://hackathon-pione-dream-vzj5.vercel.app", // Chatbot
            "http://localhost:3000"                         // Development
        ));
        
        // Cho phÃ©p táº¥t cáº£ methods: GET, POST, PUT, DELETE
        config.setAllowedMethods(Arrays.asList("GET", "POST", "PUT", "DELETE"));
        
        return new CorsFilter(source);
    }
}
```

**Káº¿t quáº£:** Frontend cÃ³ thá»ƒ gá»i Backend khÃ´ng bá»‹ cháº·n

---

## ğŸ“± **VÃ Dá»¤ THá»°C Táº¾**

### **Scenario: PhÃ¡t hiá»‡n bá»‡nh lÃ¡ lÃºa mÃ¬**

```
1. NÃ´ng dÃ¢n má»Ÿ app trÃªn Ä‘iá»‡n thoáº¡i
   URL: https://hackathon-pione-dream.vercel.app/

2. Click "PhÃ¡t hiá»‡n bá»‡nh", chá»n áº£nh tá»« thÆ° viá»‡n

3. Frontend gá»­i áº£nh lÃªn Backend:
   POST https://hackathonpionedream-production.up.railway.app/api/pest-disease/detect
   Body: FormData vá»›i file áº£nh

4. Backend nháº­n áº£nh, forward Ä‘áº¿n Pest AI:
   POST https://kimngan0407-pest-disease.hf.space/api/detect
   Body: áº£nh

5. Pest AI phÃ¢n tÃ­ch:
   - Load áº£nh
   - Cháº¡y Vision Transformer model
   - Dá»± Ä‘oÃ¡n: "Brown Rust" vá»›i confidence 95%

6. Pest AI tráº£ káº¿t quáº£ vá» Backend:
   {
     "predicted_class": "Brown Rust",
     "confidence": 0.95
   }

7. Backend lÆ°u vÃ o Database (optional)

8. Backend tráº£ káº¿t quáº£ vá» Frontend

9. Frontend hiá»ƒn thá»‹ cho nÃ´ng dÃ¢n:
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  Káº¿t quáº£ phÃ¡t hiá»‡n:     â”‚
   â”‚  ğŸ› Brown Rust          â”‚
   â”‚  ğŸ“Š Äá»™ chÃ­nh xÃ¡c: 95%   â”‚
   â”‚                         â”‚
   â”‚  ğŸ’¡ Khuyáº¿n nghá»‹:        â”‚
   â”‚  - Phun thuá»‘c...        â”‚
   â”‚  - TÄƒng thÃ´ng giÃ³...    â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

10. NÃ´ng dÃ¢n nháº­n thÃ´ng tin vÃ  xá»­ lÃ½
```

---

## ğŸš€ **TRIá»‚N KHAI**

### **ÄÃ£ deploy á»Ÿ Ä‘Ã¢u?**

| Pháº§n | Platform | URL | Status |
|------|----------|-----|--------|
| Frontend | Vercel | hackathon-pione-dream.vercel.app | âœ… |
| Backend | Railway | hackathonpionedream-production.up.railway.app | âœ… |
| Database | Railway | Internal connection | âœ… |
| Pest AI | Hugging Face | kimngan0407-pest-disease.hf.space | âœ… |
| Crop AI | Render | hackathon-pione-dream.onrender.com | âœ… |

### **Tá»± Ä‘á»™ng deploy:**

```
Code thay Ä‘á»•i â†’ Push lÃªn GitHub â†’ Platform tá»± Ä‘á»™ng deploy

Frontend: Git push â†’ Vercel auto-deploy (~1 phÃºt)
Backend:  Git push â†’ Railway auto-deploy (~3 phÃºt)
```

---

## âœ… **TÃ“M Táº®T**

**CÃ¡c pháº§n káº¿t ná»‘i vá»›i nhau thÃ´ng qua:**

1. **HTTP/HTTPS requests** - Frontend gá»i Backend qua REST API
2. **REST API calls** - Backend gá»i AI services qua HTTP
3. **Database connection** - Backend káº¿t ná»‘i PostgreSQL qua JDBC
4. **CORS configuration** - Cho phÃ©p cross-origin requests
5. **Environment variables** - Config URLs vÃ  credentials

**Táº¥t cáº£ Ä‘Ã£ Ä‘Æ°á»£c cáº¥u hÃ¬nh vÃ  sáºµn sÃ ng hoáº¡t Ä‘á»™ng!** âœ…

---

## ğŸ“– **Äá»ŒC THÃŠM**

- File chi tiáº¿t: `KET_NOI_CAC_SERVICES.md`
- Architecture: `SYSTEM_ARCHITECTURE.md`
- Deployment: `FINAL_DEPLOYMENT_CHECKLIST.md`

---

**ğŸ‰ Há»† THá»NG Cá»¦A Báº N ÄÃƒ HOÃ€N TOÃ€N Káº¾T Ná»I Vá»šI NHAU VÃ€ HOáº T Äá»˜NG!**

